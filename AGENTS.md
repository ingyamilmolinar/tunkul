# Project Guidelines

- Use Go 1.23.x as specified in `go.mod`.
- **Always run `go test -tags test -modfile=go.test.mod ./...` and ensure it passes before opening a PR.**  
  Using the real `go.mod` will fail to compile the UI tests because the
  production Ebiten library lacks the stubbed input helpers.
- Build the WebAssembly binary using `make all` from the repo root.
- The `src/js/main.wasm` file is generated by `make`; avoid committing changes to it.
- UI code resides under `src/go/internal/ui`. Automated tests rely on the Ebiten stubs via `go.test.mod`.
- For native builds using the real Ebiten library, run `scripts/setup-ebiten-env.sh` to install the necessary system packages (Homebrew or apt).

## Project Overview

Tunkul is a grid-based beat sequencer written in Go with Ebiten. The program renders a node graph where each node represents a drum hit. A bottom drum-machine panel shows the active steps. The scheduler in `core/beat` triggers beats at a configurable BPM using the pure data structures from `core/model`. The UI layer translates mouse and keyboard input into model operations and draws the results with Ebiten.

Key technologies:
- Go 1.23
- Ebiten for cross-platform rendering (stubbed for headless tests)
- WASM build via `make all`

Code structure:
- `core/model` – pure graph and drum row logic (unit tested)
- `core/beat` – beat scheduler (integration tested)
- `internal/ui` – controller and renderer using Ebiten

